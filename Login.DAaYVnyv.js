import{_ as b,q as y,a as V,c as q,b as m,d as r,w as s,k as x,f as l,x as k,e as d,v as h}from"./index.DF3behv_.js";import{u as N}from"./user.DWHd_fX-.js";import"./index.CnCq3VPH.js";const B={class:"login-container"},C={class:"login-form-wrapper"},F={__name:"Login",setup(L){const c=h(),f=y(),o=k({username:"",password:""}),g={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},t=d(null),a=d(!1),_=async()=>{t.value&&t.value.validate(async i=>{if(i){a.value=!0;try{console.log("开始登录请求:",{username:o.username});const e=await N.login(o.username,o.password);console.log("登录请求返回:",e),e.success?(f.login(e.user),c.push("/")):(console.error("登录失败（服务器返回错误）:",e.error),alert("登录失败: "+e.error))}catch(e){console.error("登录失败（异常）:",e),console.error("错误详情:",{message:e.message,response:e.response,request:e.request,config:e.config}),e.message.includes("Network Error")?(console.error("网络错误：可能是后端服务未启动或网络连接问题"),alert("网络连接失败，请检查网络设置和后端服务是否运行")):e.response?(console.error("服务器错误状态码:",e.response.status),console.error("服务器错误信息:",e.response.data),alert("登录失败: "+(e.response.data?.error||"服务器错误"))):e.request?(console.error("请求已发送但无响应:",e.request),alert("网络连接失败，服务器无响应")):(console.error("请求配置错误:",e.message),alert("登录失败: "+e.message))}finally{a.value=!1}}})};return(i,e)=>{const p=l("el-input"),n=l("el-form-item"),w=l("el-button"),v=l("el-form");return V(),q("div",B,[m("div",C,[e[3]||(e[3]=m("h1",{class:"login-title"},"SmartAppHub 登录",-1)),r(v,{model:o,rules:g,ref_key:"loginFormRef",ref:t,"label-width":"80px"},{default:s(()=>[r(n,{label:"用户名",prop:"username"},{default:s(()=>[r(p,{modelValue:o.username,"onUpdate:modelValue":e[0]||(e[0]=u=>o.username=u),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),r(n,{label:"密码",prop:"password"},{default:s(()=>[r(p,{modelValue:o.password,"onUpdate:modelValue":e[1]||(e[1]=u=>o.password=u),type:"password",placeholder:"请输入密码","show-password":""},null,8,["modelValue"])]),_:1}),r(n,null,{default:s(()=>[r(w,{type:"primary",onClick:_,loading:a.value,style:{width:"100%"}},{default:s(()=>[...e[2]||(e[2]=[x(" 登录 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])])}}},A=b(F,[["__scopeId","data-v-e34701b1"]]);export{A as default};
